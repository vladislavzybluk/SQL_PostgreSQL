with
wi1 as (select  count(i2011.invoice_id) as year_2011,
        EXTRACT(month from CAST(invoice_date AS timestamp)) as month
        from invoice as i2011
        where EXTRACT(year from CAST(invoice_date AS timestamp)) = 2011
        group by EXTRACT(month from CAST(invoice_date AS timestamp))), 

wi2 as (select  count(i2012.invoice_id) as year_2012,
        EXTRACT(month from CAST(invoice_date AS timestamp)) as month
        from invoice as i2012
        where EXTRACT(year from CAST(invoice_date AS timestamp)) = 2012
        group by EXTRACT(month from CAST(invoice_date AS timestamp))),
        
wi3 as (select  count(i2013.invoice_id) as year_2013,
        EXTRACT(month from CAST(invoice_date AS timestamp)) as month
        from invoice as i2013
        where EXTRACT(year from CAST(invoice_date AS timestamp)) = 2013
        group by EXTRACT(month from CAST(invoice_date AS timestamp))) 


SELECT  wi1.year_2011,
        wi2.year_2012,
        wi3.year_2013,
        wi1.month 
        
FROM wi1



LEFT JOIN wi2 ON wi1.month = wi2.month

LEFT JOIN wi3 ON wi1.month = wi3.month

order by month  asc
limit 12

