select customer_id,
       invoice_date,
       total,
       EXTRACT(WEEK FROM CAST(invoice_date AS date)),
       DATE_TRUNC('month', CAST(invoice_date AS timestamp))
       
       from
(SELECT customer_id,  -- сам по себе этот запрос работать не будет потому что он фильтует данные которые не создались поэтому оформил в форме подзапроса
       invoice_date,
       total,
       DATE_TRUNC('month', CAST(invoice_date AS date)),
       --EXTRACT(WEEK FROM CAST(invoice_date AS date)),
       EXTRACT(WEEK FROM CAST(invoice_date AS timestamp))
       
       
       
FROM invoice
WHERE (customer_id BETWEEN 20 AND 50)
) src
where DATE_PART IN (5,7,10,24,48);




--select *

SELECT customer_id,
       invoice_date,
       total,
       invoice_id,
       BILLING_ADDRESS,
       BILLING_CITY,
       BILLING_STATE,
       BILLING_COUNTRY,
       BILLING_POSTAL_CODE

from (SELECT *,
        EXTRACT(DAY FROM CAST(invoice_date AS timestamp)) 
FROM invoice
) src
where DATE_PART IN (1);


-- more simpler way

SELECT EMAIL
FROM staff
WHERE  EXTRACT(YEAR FROM CAST(HIRE_DATE AS timestamp)) = 2002 AND CITY = 'Calgary';
