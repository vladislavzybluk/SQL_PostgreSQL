год покупки;
минимальная сумма заказа;
максимальная сумма заказа;
общая сумма выручки;
количество заказов;
средняя выручка на уникального покупателя, округлённая до ближайшего целого числа.
Отсортируйте таблицу по году от большего к меньшему. Отберите только те записи, в которых в поле billing_country указаны страны: США (англ. USA), Великобритания (англ. United Kingdom) и Германия (англ. Germany).

SELECT 
        EXTRACT (YEAR FROM CAST(invoice_date AS timestamp)), 
        min(total), 
        max(total), 
        sum(total), 
        count(invoice_id), 
        ROUND(sum(total)/count(distinct(customer_id)))
FROM invoice
WHERE billing_country = 'USA' or billing_country = 'Germany' or billing_country = 'United Kingdom'

GROUP BY EXTRACT (YEAR FROM CAST(invoice_date AS timestamp))
ORDER BY date_part DESC

