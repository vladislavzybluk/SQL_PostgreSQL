SELECT  p.name as playlist_name,
        SUM(t.unit_price) as total_revenue
FROM track AS t
INNER JOIN invoice_line AS i ON t.track_id=i.track_id
INNER JOIN playlist_track AS pl ON t.track_id=pl.track_id
INNER JOIN playlist AS p ON pl.playlist_id = p.playlist_id
GROUP BY p.name
ORDER BY total_revenue DESC

-- --

SELECT  g.name,
        count(i.invoice_id)  as total_orders
FROM track AS t
INNER JOIN genre AS g ON g.genre_id = t.genre_id
INNER JOIN invoice_line AS il ON il.track_id = t.track_id
INNER JOIN invoice AS i ON il.invoice_id=i.invoice_id
GROUP BY g.name
ORDER BY total_orders DESC

-- --

SELECT c.name AS uniq
        
FROM movie AS m

INNER JOIN film_category AS fc ON m.film_id=fc.film_id
INNER JOIN film_actor AS fa ON m.film_id=fa.film_id
INNER JOIN actor AS a ON a.actor_id=fa.actor_id
INNER JOIN category AS c ON c.category_id=fc.category_id
WHERE (a.first_name LIKE '%Uma%')
      AND (a.last_name LIKE '%Wood%')
GROUP BY uniq

-- --

SELECT  s.last_name as employee_last_name,
        count(c.customer_id) as all_customers
FROM staff as s
LEFT JOIN client AS c ON c.support_rep_id = s.employee_id
GROUP BY employee_last_name
ORDER BY all_customers desc
limit 10

-- --

SELECT s.last_name as manager_last_name,
       mn.last_name as employee_last_name
FROM staff AS s
RIGHT JOIN staff AS mn ON mn.reports_to=s.employee_id

