/*
SELECT customer_id
        FROM invoice
        WHERE EXTRACT(YEAR FROM CAST(invoice.invoice_date AS date)) = 2013  
        AND EXTRACT(month FROM CAST(invoice.invoice_date AS date))  = 1

SELECT customer_id
        FROM invoice
        WHERE EXTRACT(YEAR FROM CAST(invoice.invoice_date AS date)) = 2013  
        AND EXTRACT(month FROM CAST(invoice.invoice_date AS date))  <> 1

*/

SELECT distinct(c.last_name)
FROM client as c
INNER JOIN 



(SELECT i1.customer_id as customer_sorted
FROM (
    SELECT customer_id 
        FROM invoice
        WHERE EXTRACT(YEAR FROM CAST(invoice.invoice_date AS date)) = 2013  
        AND EXTRACT(month FROM CAST(invoice.invoice_date AS date))  = 1

) as i1 INNER JOIN (

    SELECT customer_id 
        FROM invoice
        WHERE EXTRACT(YEAR FROM CAST(invoice.invoice_date AS date)) = 2013  
        AND EXTRACT(month FROM CAST(invoice.invoice_date AS date))  <> 1
    
) as i2 on i1.customer_id=i2.customer_id) as cl ON c.customer_id=cl.customer_sorted
